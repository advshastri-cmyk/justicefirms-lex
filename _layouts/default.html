<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ page.title }} | {{ site.title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="{{ page.excerpt | strip_html | truncate: 150 }}">
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <div class="brand">
        <a href="{{ '/' | relative_url }}" class="logo">JusticeFirms</a>
        <span class="tagline">Legal Blog</span>
      </div>
      <nav class="nav">
        <a href="{{ '/' | relative_url }}">Articles</a>
        <a href="https://justicefirms.com" target="_blank" rel="noopener">Main website</a>
      </nav>
    </div>
  </header>

  <main class="site-main">
    <div class="container">

      {%- if page.collection == "posts" -%}
      <nav class="breadcrumb">
        <a href="{{ '/' | relative_url }}">Home</a>
        {%- if page.categories and page.categories.size > 0 -%}
          <span class="breadcrumb-sep">›</span>
          <span class="breadcrumb-cat">
            {{ page.categories | join: " · " }}
          </span>
        {%- endif -%}
      </nav>
      {%- endif -%}

      {{ content }}

      {%- if page.collection == "posts" -%}
      <div class="post-footer-meta">
        <div class="share-bar">
          <span class="share-label">Share this article:</span>
          <a
            class="share-btn"
            href="https://wa.me/?text={{ page.title | uri_escape }}%20{{ site.url | append: page.url }}"
            target="_blank" rel="noopener"
          >
            WhatsApp
          </a>
          <a
            class="share-btn"
            href="https://twitter.com/intent/tweet?text={{ page.title | uri_escape }}&url={{ site.url | append: page.url }}"
            target="_blank" rel="noopener"
          >
            X (Twitter)
          </a>
          <a
            class="share-btn"
            href="https://www.linkedin.com/sharing/share-offsite/?url={{ site.url | append: page.url }}"
            target="_blank" rel="noopener"
          >
            LinkedIn
          </a>
        </div>
      </div>
      {%- endif -%}

    </div>
  </main>

  <footer class="site-footer">
    <div class="container">
      <p>© {{ site.time | date: '%Y' }} JusticeFirms. All Rights Reserved.</p>
      <p class="muted">Corporate • Family • Criminal • IP • Business Law</p>
    </div>
  </footer>

  {%- if page.collection == "posts" -%}
  <script>
  // Auto "On this page" TOC for post-page headings
  document.addEventListener("DOMContentLoaded", function () {
    const post = document.querySelector(".post-page");
    if (!post) return;

    // Find all h2 / h3 inside post
    const headings = post.querySelectorAll("h2, h3");
    if (!headings.length) return;

    // Create TOC container
    const toc = document.createElement("nav");
    toc.className = "toc";
    const list = document.createElement("ul");

    headings.forEach(function (h, index) {
      if (!h.id) {
        h.id = "section-" + (index + 1);
      }
      const li = document.createElement("li");
      li.className = h.tagName === "H2" ? "toc-h2" : "toc-h3";

      const a = document.createElement("a");
      a.href = "#" + h.id;
      a.textContent = h.textContent.trim();

      li.appendChild(a);
      list.appendChild(li);
    });

    const title = document.createElement("div");
    title.className = "toc-title";
    title.textContent = "On this page";

    toc.appendChild(title);
    toc.appendChild(list);

    // Insert TOC just after main heading (h1)
    const h1 = post.querySelector("h1");
    if (h1 && h1.nextSibling) {
      post.insertBefore(toc, h1.nextSibling);
    } else {
      post.insertBefore(toc, post.firstChild);
    }
  });
  </script>
  {%- endif -%}
</body>
</html>
